fields:
- path: "$.spec.containers.name"
  required: true

- path: "$.spec.containers.image"
  required: true

- path: .*\.containers\..*gmsaCredentialSpecName
  regex: true
  regex_values:
    - "static"

- path: "$.spec.containers.securityContext.seccompProfile.localhostProfile"
  remove: true

- path: "$.spec.containers.securityContext.seccompProfile.type"
  values: 
    - "RuntimeDefault" 
  values_mode: override


- path: "$.spec.containers.securityContext.privileged"
  values:
  - true
  required: true

- path: "$.spec.containers.securityContext.windowsOptions.hostProcess"
  values:
  - false


- path: "$.spec.containers.securityContext.allowPrivilegeEscalation"
  values:
  - true
  required: true
  values_mode: add


- "$.spec.containers.securityContext"

gvk: ".v1.Pod"
